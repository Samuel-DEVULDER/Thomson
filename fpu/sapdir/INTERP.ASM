*ñ=====================================*ñinteractiveñcalculator*ñ=====================================interpòpshsòd,x,y,u,dp,ccòldbó$6073õ;ñbackupñbuzzòpshsòbòclró$6073õ;ñdisableñbuzzòjsrótimeInitò;ñinitñtimeròlduó#fpstackò;ñsetupñfpuñstackòldxó#welcomeò;ñprintsñwelcomeòjsróputsö;ñmessageòincbü;ñflagñinterpreteròstbórunningòDOôbsróprPromptôldxó#inpbufôldyó#inpendôjsrógetsôDOöjsrónxtTokenöldbó,xöbeqóEXITò;ñnoñmoreñtokensñ=>ñpröldyó#cmdsöbsrófindCmdöldbó,yöDOIFòmiøbsrñtryFltò;ñnoñcmdñ=>ñtryñfloaöDOELSEøjsrñdoExecò;ñgotñcmdñ=>ñexecöDONEôWHILEñraôldbórunningòWHILEñneòpulsòbòstbó$6073òjsrótimeExitòldxó#byeòjsróprintlnòpulsòd,x,y,u,dp,ccòswiòrtsprPromptòldxó#outbufòleayò,xòjsróstksizeó;ñbuildñpromptòoraó#1ø;ñkeepñleadingñ0òjsrófpwrbòlddó#32+256*'>ò;ñaddñ'>ñ'òstdó,y++òclró,yòjmpóputstryFltòjsrófprdxòldbó,xø;ñreadñuptoñendñofñtokòcmpbò#32òDOIFòhiôjsrófpdropò;ñnoñ=>ñcancelñstackôpshsòxôldxó#syntaxôjsróputsôpulsòxôDOöldbó,x+ó;ñadvanceñtillñnextñtoöcmpbò#32öblsóEXITöjsróputcôWHILEñraôleaxò-1,xôpshsòxôldxó#crlfó;ñputsñanñerrorôjsróputsôpulsòxôclrótimeEnòDONEòrtsfindCmdòDOôpshsôxõ;ñsaveñtokenñptrôDOöldbó,xô;ñgetñnxtñcharöcmpbò#32öblsóEXITò;ñnoneñ=>ñbreakñloopöDOøcmpbò#'Añ;ñmakeñlowerñcaseøbloóEXITøcmpbò#'ZøbhióEXITøaddbò#'a-'AöDONEöcmpbò,yô;ñcompareñwithñcmdöbneóEXITöleaxò1,xöleayò1,yôWHILEóraôDOöldbó,xô;ñxñfinishedñ?öcmpbò#32öbhióEXITò;ñnoñ=>ñtryñnextöldbó,yöcmpbò#10ó;ñyñfinishedñ?öbhsóEXITò;ñnoñ=>ñtryñnextöstxó,söpulsòx,pcò;ñx,yñfinished=>foundôDONEôpulsôxõ;ñresetñtokenñptrôDOöldbó,y+ó;ñreadñwholeñcmdñdescöcmpbò#10ôWHILEñhsôleayô2,yó;ñskipñaddrôldbõ,yô;ñnextñcmdñvalidñ?òWHILEñplòrts*ñexecuteñcmdñpointedñbyñydoExecòpshsòxòjsróstksizeòcmpbò,y+òDOIFòloôldxó#beepstrôjsróputsôclrótimeEnòDOELSEôldbótimeEnôDOIFòneôbsródoTimingôclrótimeEnôDONEôjsró[,y]òDONEòpulsòx,pc*ñadvanceñtoñnextñtokennxtTokenòDOôldbó,x+ôbeqóEXITôcmpbò#32òWHILEólsòleaxô-1,xòrts*ñreturnsñtheñfp-stackñlengthñinñregñDstksizeòpshsòuòlddó#fpstackòsubdò,s++òlsraòrorbòlsraòrorbòrtsTIMELPòequõ150doTimingòldxó#timingStròjsróputsòclraòclrbòstbóputcEnòstdótimeCtòldxó#TIMELPòDOôbsródoDryExecôadddò#1ôDOIFñeqölddñ#-1öbrañEXIT2ôDONEôcmpxòtimeCtòWHILEñccòjsrófpldduòlddótimeCtòjsrófpldduòjsrófpoveròjsrófp_m10òjsrófpoveròjsrófpdivòjsrófprot_òjsrófp_m10òjsrófp_m10òjsrófpswapòjsrófpdivòincóputcEnòldxó#timeResStròjsróputsòjsródoDotòldxó#flopsResStròjsróputsòjmpódoDot*ñexecuteñtheñcommandñwithoutñaffecting*ñtheñstackdoDryExecòpshsòd,x,u÷;ñpreserveñregsòldbó-1,yø;ñgetñarityòDOIFòneôDOödecbú;ñarg-indexöstbó,-sõ;ñpreserveöldbó-1,yödecböjsrófppickò;ñpushñarg-1öldbó,s+ôWHILEñneòDONEòjsró[,y]òpulsòd,x,u,pc*ñgivenñañbufferñinñxñ(endingñinñy-1),ñr*ñresultñisñañnul-terminatedñstringgetsòpshsòd,y,xù;ñpreserveñregsòclró-1,yø;ñendñofñbufferñsentòDOôjsró$E806ôtstbôbeqóREDOôcmpbò#13÷;ñreturnôbeqóEXITôcmpbò#8ø;ñbackôDOIFòeqöcmpxò2,sõ;ñalreadyñatñstartñ?öDOIFñneøleaxò-1,xò;ñgoñbackølddó#1øbsróbackspöDONEöbraóREDO2ôDONEôcmpbò#9ø;ñrightôDOIFòeqöldbó,x+öDOIFñeq÷;ñendñofñbufferñreacøleaxò-1,xò;ñadvanceøldbó#7ô;ñbeepöDONEöbsróputcô;ñprintñcharöbraóREDO2ôDONEôcmpbò#10÷;ñdownñ-->ñclearñlinôDOIFòeqötfróx,dösubdò2,söbsróbackspöldxó2,söbraóREDO2ôDONEôcmpbò#11÷;ñupñ-->ñprintñpreviôDOIFòeqöbsróputsöleaxò-1,xöbraóREDO2ôDONEôcmpbò#32÷;ñ<ñ'ñ'ôbloóREDOö;ñyesñ=>ñignoreôcmpbò#127ö;ñ>ñ127ôbhióREDOö;ñyesñ=>ñignoreôcmpxò4,s÷;ñatñendñofñbufferñ?ôDOIFòhsöldbó#7ö;ñbeepöbsróputcöbraóREDO2ôDONEôstbó,x+ôbsróputcòWHILEñraòclró,xú;ñendñofñstringòbsróprintlnõ;ñprintsñcrlfòpulsòd,x,y,pc*ñprintsñañbackspaceñofñ"d"ñlengthbackspòpshsòd,xòldxó,sòDOIFòneôldbó#8ôbsróbacksp2ôldxó,sôldbó#32ôbsróbacksp2ôldxó,sôldbó#8ôbsróbacksp2òDONEòpulsòd,x,pcbacksp2òDOôbsróputcôleaxò-1,xòWHILEñneòrts*ñprintsñañlineñpointedñbyñxñ(trashed)printlnòbsróputsòldxó#crlfòSKIP2ù;ñskipñoverñbsrñputc*ñprintsñañnul-terminatedñstringòDOôbsróputcò;ñprintñcharputsôldbó,x+ó;ñloadñnextñcharòWHILEñneö;ñany?ñno=>ñloopòrts*ñprintsñañcharputcòtstóputcEnòDOIFòeqôrtsòDONEòjmpó$E803*ñprintsñcurrentñfloatdoDotòldxó#outbufdoDot2òjsrófpwrxòldxó#outbufòbraóprintln*ñprintsñfullñstackdoDotSòjsróstksizeòpshsòb,x,yòDOIFòneôDOödecböstbó,-söcomböaddbò1,söldyó#outbuföldaó#1öjsrófpwrbölddó#32+256*':ñ;ñaddñ':ñ'östdó,y++öldbó,söjsrófppicköleaxò,yöbsródoDot2öldbó,s+ôWHILEóneòDONEòpulsòb,x,y,pcdoQuitòclrórunningòclró,xú;ñstopñprocessingòrtsdoZòldxó#outbufòjsrófpwrxòldxó#outbufòjmpóprintlndoNopòrtstimeInitòldxó#timeItõ;ñactivateñtimeròstxó$6027*ñstxó$6021òldaó$6019òoraó#32òstaó$6019òandccñ#255-$50òrtstimeExitòldaó$6019òandaò#255-32òstaó$6019òrtstimeItòincótimeCt+1òDOIFñeqôincñtimeCtòDONEòjmpó$E830timeOnòincótimeEnòrts*ñ=====================================cmdsòfccó/./õ;ñnameòfcbó1÷;ñartiryñ<ñ10òfdbódoDotó;ñexecñaddròfccó/.s/òfcbó0òfdbódoDotSòfccó/+/òfcbó2òfdbófpaddòfccó/-/òfcbó2òfdbófpaddòfccó/*/òfcbó2òfdbófpmulòfccó%/%òfcbó2òfdbófpdivòfccó/sqrt/òfcbó1òfdbófpsqrtòfccó/dup/òfcbó1òfdbófpdupòfccó/drop/òfcbó1òfdbófpdropòfccó/over/òfcbó2òfdbófpoveròfccó/time/òfcbó0òfdbótimeOnòfccó/quit/òfcbó0òfdbódoQuitòfccó/z/òfcbó1òfdbódoZòfccó/nop/òfcbó0òfdbódoNopòfccó%1/%òfcbó1òfdbófpinvòfccó%*2%òfcbó1òfdbófpshlòfccó%/2%òfcbó1òfdbófpshròfccó%1/sqrt%òfcbó1òfdbófpinvsqrtòfcbó-1ö;ñendñofñcmdswelcomeòfcbó$1B,$68òfccó/RPNñcalc/crlfòfcbó13,10,0byeòfcbó$1B,$69òfccó/Bye.../òfcbó0syntaxòfccó/???ñ/beepstròfcbó7,0timingStròfccó/timingñforñ/òfcbó(TIMELP/100)+'0òfcbó((TIMELP/10)%10)+'0òfccó/./òfcbóTIMELP%10+'0òfccó/s.../òfcbó0timeResStròfcbó13,$18òfccó/time(ms)ñ=ñ/òfcbó0flopsResStròfccó/flopsô=ñ/òfcbó0*ñ=====================================runningòfcbó-1ò;ñcalcñrunningputcEnòfcbó-1ò;ñputcñenabledñ?timeEnòfcbó0ó;ñtimingñenabledñ?timeCtòfdbó0ó;ñtimerñcounter*ñ=====================================inpbufòrmbó256inpendòsetó*outbufòrmbó256outendòsetó*ørmbó128*4fpstackñsetó*