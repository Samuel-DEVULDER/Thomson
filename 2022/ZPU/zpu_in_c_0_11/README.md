Code from https://forums.parallax.com/uploads/attachments/52350/70173.zip, a bit addapted to serve as reference for ZPU.ass
